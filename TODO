-- Calculate balance:

SELECT p.balance+c.total-c.payment FROM account_period AS c JOIN account_period AS p ON c.account=p.account AND p.period=(c.period-1) WHERE c.account=1 ORDER BY c.period;

-- to test
UPDATE account_period
	SET c.balance = p.balance+c.total-c.payment
	FROM account_period AS c
	JOIN account_period AS p
		ON c.account=p.account AND p.period=c.period-1
	WHERE c.period=?



function method_0 ()
	return tax.amount;
end

function method_1 ()
	return 1;
end

function method_2 ()
	return account.n_area;
end

function method_3 ()
	return account.n_people;
end

function method_4 ()
	local val = refs['electricity_norm'].get_value ({
		period = account.period,
		n_rooms = clamp (account.n_rooms, 1, 4),
		n_people = clamp (account.n_people, 1, 5),
		heater = account.custom['has_electric_heater'];
	});

	return val * account.n_people;
end
